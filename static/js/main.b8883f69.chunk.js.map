{"version":3,"sources":["components/AuthRoute.tsx","components/Navbar.jsx","components/Footer.jsx","pages/index/components/Slides.jsx","pages/index/components/Articles.tsx","pages/index/components/Notifications.tsx","pages/index/components/NotificationsMobile.tsx","pages/index/Index.tsx","App.tsx","serviceWorker.js","index.tsx","context/Reducer.js","context/GlobalState.tsx","hooks/Api.js","components/LoginDialog.jsx","types.ts"],"names":["LoginAlert","maxWidth","variant","severity","action","NotAuthorizedAlert","AuthRoute","children","path","pageAccessCode","authInfo","useContext","authInfoContext","loggedIn","userAccessCode","canAccess","accessCode","useStyles","makeStyles","theme","root","flexGrow","width","offset","mixins","toolbar","logo","display","breakpoints","up","pages","label","PageLabel","Index","to","PagePath","About","Repair","Check","Wechat","Lanke","Suggest","Complain","NavBar","classes","pathname","useLocation","React","useState","currentPage","setCurrentPage","anchorEl","setAnchorEl","useEffect","firstLevelPath","slashIndex","indexOf","slice","indexMatch","findIndex","page","includes","handleCloseUserMenu","className","AppBar","position","color","Grid","container","item","xs","src","process","alt","height","style","top","left","Tabs","value","indicatorColor","textColor","scrollButtons","map","index","Tab","key","component","Link","sm","Divider","orientation","textAlign","IconButton","onClick","event","currentTarget","Menu","id","anchorOrigin","vertical","horizontal","keepMounted","transformOrigin","open","Boolean","onClose","MenuItem","ListItemIcon","LoginDialog","Copyright","Typography","align","href","Date","getFullYear","footer","padding","spacing","bottom","marginTop","backgroundColor","palette","primary","light","StickyFooter","Container","AutoPlaySwipeableViews","autoPlay","SwipeableViews","slide","margin","img","Slides","Skeleton","pagination","numPerPage","ArticleList","setOffset","Paper","List","subheader","ListSubheader","disableSticky","limit","total","e","newOffset","marginRight","NestedList","elevation","dense","ListItem","button","ListItemText","primaryTypographyProps","reduced","PaperSheet","ExpansionPanel","ExpansionPanelSummary","expandIcon","ExpansionPanelDetails","justify","Hidden","smUp","md","xsDown","NotFoundPage","lazy","AboutPage","CheckPage","ComplainPage","LankePage","RepairPage","SuggestPage","WechatPage","AdminPage","App","darkThemeSys","useMediaQuery","noSsr","createMuiTheme","main","secondary","type","GlobalState","CssBaseline","minHeight","fallback","CircularProgress","exact","IndexPage","AdminAccess","Dashboard","Admin","window","location","hostname","match","ReactDOM","render","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister","initialState","userId","identity","Identity","None","expires","userReducer","state","localStorage","setItem","token","ROOT","removeItem","createContext","login","logout","useReducer","getItem","dispatch","Provider","base","REACT_APP_DOMAIN","instance","require","default","create","baseURL","timeout","withCredentials","interceptors","request","use","config","csrfToken","name","nameEQ","ca","cookie","split","i","length","c","charAt","substring","readCookie","headers","console","log","error","Promise","reject","response","data","setOpen","context","handleClickOpen","handleClose","handleLogout","Dialog","DialogTitle","DialogContent","DialogContentText","DialogActions","Button","a","async","title","content","pinned","public","Api","post","res"],"mappings":"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","file":"static/js/main.b8883f69.chunk.js","sourcesContent":["import { Alert } from \"@material-ui/lab\";\nimport React, { useContext } from \"react\";\nimport { Route } from \"react-router-dom\";\nimport { authInfoContext } from \"../context/GlobalState\";\nimport { AuthRouteProps, GlobalContextProps } from \"../types\";\nimport LoginDialog from \"./LoginDialog\";\nimport { Container } from \"@material-ui/core\";\n\nfunction canAccess(pageAccessCode: number, userAccessCode: number): boolean {\n  return (pageAccessCode & userAccessCode) !== 0;\n}\n\nfunction LoginAlert(): JSX.Element {\n  return (\n    <Container maxWidth=\"sm\">\n      <Alert variant=\"outlined\" severity=\"warning\" action={<LoginDialog />}>\n        您需要先登陆才能访问此页面！\n      </Alert>\n    </Container>\n  );\n}\n\nfunction NotAuthorizedAlert(): JSX.Element {\n  return (\n    <Container maxWidth=\"sm\">\n      <Alert variant=\"outlined\" severity=\"error\">\n        您没有权限访问该页面！\n      </Alert>\n    </Container>\n  );\n}\n\nexport const AuthRoute: React.FC<AuthRouteProps> = ({\n  children,\n  path,\n  pageAccessCode\n}) => {\n  const context = useContext<GlobalContextProps>(authInfoContext);\n  const { authInfo } = context;\n\n  return (\n    <Route\n      path={path}\n      // eslint-disable-next-line react/no-children-prop\n      children={(): JSX.Element => {\n        if (\n          !authInfo.loggedIn ||\n          !canAccess(pageAccessCode, authInfo.accessCode)\n        ) {\n          return authInfo.loggedIn ? <NotAuthorizedAlert /> : <LoginAlert />;\n        }\n        return children;\n      }}\n    />\n  );\n};\n","import {\n  Divider,\n  Grid,\n  IconButton,\n  AppBar,\n  Tabs,\n  Tab,\n  makeStyles,\n  Menu,\n  MenuItem,\n  ListItemIcon\n} from \"@material-ui/core\";\nimport AccountIcon from \"@material-ui/icons/AccountCircle\";\nimport AppsIcon from \"@material-ui/icons/Apps\";\nimport React, { useEffect } from \"react\";\nimport { Link, useLocation } from \"react-router-dom\";\nimport LoginDialog from \"./LoginDialog\";\nimport { PageLabel, PagePath } from \"../types\";\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    flexGrow: 1,\n    width: \"100%\"\n  },\n  offset: theme.mixins.toolbar,\n  logo: {\n    display: \"none\",\n    [theme.breakpoints.up(\"sm\")]: {\n      display: \"block\"\n    }\n  }\n}));\n\nconst pages = [\n  { label: PageLabel.Index, to: PagePath.Index },\n  { label: PageLabel.About, to: PagePath.About },\n  { label: PageLabel.Repair, to: PagePath.Repair },\n  { label: PageLabel.Check, to: PagePath.Check },\n  { label: PageLabel.Wechat, to: PagePath.Wechat },\n  { label: PageLabel.Lanke, to: PagePath.Lanke },\n  { label: PageLabel.Suggest, to: PagePath.Suggest },\n  { label: PageLabel.Complain, to: PagePath.Complain }\n];\n\nexport default function NavBar() {\n  const classes = useStyles();\n  const { pathname } = useLocation();\n  const [currentPage, setCurrentPage] = React.useState(0);\n  const [anchorEl, setAnchorEl] = React.useState(null);\n\n  useEffect(() => {\n    // 导航栏匹配一级路由\n    /*\n      /about      -> /about\n      /about/     -> /about\n      /about/123  -> /about\n    */\n    let firstLevelPath = pathname;\n    const slashIndex = firstLevelPath.indexOf(\"/\", 1);\n    if (slashIndex !== -1) {\n      firstLevelPath = firstLevelPath.slice(0, slashIndex);\n    }\n\n    const indexMatch = pages.findIndex(page => firstLevelPath === page.to);\n    setCurrentPage(indexMatch);\n  }, [pathname]);\n\n  if (pathname.includes(\"admin\")) {\n    return null;\n  }\n\n  const handleOpenUserMenu = event => {\n    setAnchorEl(event.currentTarget);\n  };\n\n  const handleCloseUserMenu = () => {\n    setAnchorEl(null);\n  };\n\n  function AccountMenu() {\n    return (\n      <Menu\n        id=\"menu-appbar\"\n        anchorEl={anchorEl}\n        anchorOrigin={{\n          vertical: \"top\",\n          horizontal: \"right\"\n        }}\n        keepMounted\n        transformOrigin={{\n          vertical: \"top\",\n          horizontal: \"right\"\n        }}\n        open={Boolean(anchorEl)}\n        onClose={handleCloseUserMenu}\n      >\n        <MenuItem onClick={handleCloseUserMenu} component={Link} to=\"/admin\">\n          <ListItemIcon>\n            <AppsIcon />\n          </ListItemIcon>\n          后台\n        </MenuItem>\n        <LoginDialog />\n      </Menu>\n    );\n  }\n\n  return (\n    <div className={classes.root}>\n      <AppBar position=\"fixed\" color=\"primary\">\n        <Grid container>\n          <Grid item xs={1} className={classes.logo}>\n            <img\n              src={`${process.env.PUBLIC_URL}/images/Logo_small_3.png`}\n              alt=\"logo\"\n              height={40}\n              style={{ position: \"relative\", top: 8, left: 4 }}\n            />\n          </Grid>\n          <Grid item xs={10}>\n            <Tabs\n              value={currentPage}\n              indicatorColor=\"secondary\"\n              textColor=\"inherit\"\n              variant=\"scrollable\"\n              scrollButtons=\"auto\"\n            >\n              {pages.map((page, index) => (\n                <Tab\n                  // eslint-disable-next-line react/no-array-index-key\n                  key={index}\n                  label={page.label}\n                  component={Link}\n                  to={page.to}\n                />\n              ))}\n            </Tabs>\n          </Grid>\n          <Grid item sm={1} xs={2}>\n            <Divider orientation=\"vertical\" style={{ position: \"absolute\" }} />\n            <div style={{ textAlign: \"center\" }}>\n              <IconButton onClick={handleOpenUserMenu}>\n                <AccountIcon />\n              </IconButton>\n            </div>\n            <AccountMenu />\n          </Grid>\n        </Grid>\n      </AppBar>\n      <div className={classes.offset} />\n    </div>\n  );\n}\n","import Container from \"@material-ui/core/Container\";\nimport Link from \"@material-ui/core/Link\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport Typography from \"@material-ui/core/Typography\";\nimport React from \"react\";\nimport { useLocation } from \"react-router-dom\";\n\nfunction Copyright() {\n  return (\n    <Typography variant=\"body2\" color=\"textSecondary\" align=\"center\">\n      {\"Copyright © \"}\n      <Link color=\"inherit\" href=\"http://lanunion.cqu.edu.cn/\">\n        重庆大学蓝盟\n      </Link>{\" \"}\n      {new Date().getFullYear()}\n    </Typography>\n  );\n}\n\nconst useStyles = makeStyles(theme => ({\n  footer: {\n    padding: theme.spacing(2),\n    bottom: 0,\n    marginTop: 100,\n    backgroundColor: theme.palette.primary.light\n  }\n}));\n\nexport default function StickyFooter() {\n  const classes = useStyles();\n  const { pathname } = useLocation();\n\n  if (pathname.includes(\"admin\")) {\n    return null;\n  }\n\n  return (\n    <footer className={classes.footer}>\n      <Container maxWidth=\"sm\">\n        <Typography variant=\"body1\" align=\"center\" color=\"textPrimary\">\n          页脚\n        </Typography>\n        <Copyright />\n      </Container>\n    </footer>\n  );\n}\n","import { makeStyles } from \"@material-ui/core\";\nimport React from \"react\";\nimport Skeleton from \"@material-ui/lab/Skeleton\";\nimport SwipeableViews from \"react-swipeable-views\";\nimport { autoPlay } from \"react-swipeable-views-utils\";\n\nconst AutoPlaySwipeableViews = autoPlay(SwipeableViews);\n\nconst useStyles = makeStyles(() => ({\n  slide: {\n    margin: 15\n  },\n  img: {\n    width: \"100%\",\n    height: \"auto\"\n  }\n}));\n\nexport default function Slides() {\n  const classes = useStyles();\n\n  return (\n    <AutoPlaySwipeableViews>\n      {[1, 2, 3].map(item => (\n        <div className={classes.slide} key={item}>\n          <Skeleton variant=\"rect\" width=\"100%\" height=\"30vh\" />\n        </div>\n      ))}\n    </AutoPlaySwipeableViews>\n  );\n}\n","// eslint-disable-next-line\nimport { Paper, Divider } from \"@material-ui/core\";\nimport List from \"@material-ui/core/List\";\n// import ListItem from \"@material-ui/core/ListItem\";\n// import ListItemText from \"@material-ui/core/ListItemText\";\nimport ListSubheader from \"@material-ui/core/ListSubheader\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport Pagination from \"material-ui-flat-pagination\";\nimport React, { useState } from \"react\";\n// import { useGetArticlesV1 } from \"../../../hooks/api\";\n// import Skeleton from \"@material-ui/lab/Skeleton\";\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    margin: \"auto\",\n    width: \"100%\",\n    maxWidth: 500,\n    padding: theme.spacing(1)\n  },\n  pagination: {\n    textAlign: \"center\"\n  }\n}));\n\n// const ArticleSkeleton = (): JSX.Element => {\n//   const item = (\n//     <div style={{ padding: 10 }}>\n//       <Skeleton height={30} width=\"20%\" />\n//       <Skeleton height={20} width=\"90%\" />\n//       <Skeleton height={20} width=\"90%\" />\n//       <Divider />\n//     </div>\n//   );\n//   return (\n//     <>\n//       {item}\n//       {item}\n//       {item}\n//     </>\n//   );\n// };\n\nconst numPerPage = 6;\n\nexport default function ArticleList(): JSX.Element {\n  const classes = useStyles();\n  const [offset, setOffset] = useState<number>(0);\n  // const { data: res } = useGetArticlesV1({\n  //   queryParams: {\n  //     offset: 0\n  //   }\n  // });\n\n  return (\n    <Paper className={classes.root}>\n      <List\n        subheader={\n          <ListSubheader component=\"span\" disableSticky>\n            文章\n          </ListSubheader>\n        }\n      >\n        {/* {res?.data.map(item => (\n          <ListItem button divider key={item.id}>\n            <ListItemText\n              primary={item.title}\n              primaryTypographyProps={{ color: \"textPrimary\" }}\n              secondary={item.content}\n              secondaryTypographyProps={{ color: \"textSecondary\" }}\n            />\n          </ListItem>\n        ))}\n        {!res && <ArticleSkeleton />} */}\n      </List>\n      <div className={classes.pagination}>\n        <Pagination\n          limit={numPerPage}\n          offset={offset}\n          total={100}\n          onClick={(e, newOffset): void => setOffset(newOffset)}\n        />\n      </div>\n    </Paper>\n  );\n}\n","import { Paper } from \"@material-ui/core\";\nimport List from \"@material-ui/core/List\";\nimport ListItem from \"@material-ui/core/ListItem\";\nimport ListItemIcon from \"@material-ui/core/ListItemIcon\";\nimport ListItemText from \"@material-ui/core/ListItemText\";\nimport ListSubheader from \"@material-ui/core/ListSubheader\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport EventNoteIcon from \"@material-ui/icons/EventNote\";\nimport Pagination from \"material-ui-flat-pagination\";\nimport React, { useState } from \"react\";\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    marginRight: \"auto\",\n    width: \"100%\",\n    maxWidth: 300,\n    padding: theme.spacing(1)\n  },\n  pagination: {\n    textAlign: \"center\"\n  }\n}));\n\nconst numPerPage = 6;\n\nexport default function NestedList() {\n  const classes = useStyles();\n  const [offset, setOffset] = useState<number>(0);\n\n  return (\n    <Paper className={classes.root} elevation={4}>\n      <List\n        component=\"nav\"\n        dense\n        subheader={\n          <ListSubheader component=\"div\" disableSticky>\n            通知\n          </ListSubheader>\n        }\n      >\n        {[1, 2, 3, 4, 5, 6].map(item => (\n          <ListItem button key={item + offset}>\n            <ListItemIcon>\n              <EventNoteIcon />\n            </ListItemIcon>\n            <ListItemText\n              primary={`通知 ${item + offset}`}\n              primaryTypographyProps={{ color: \"textPrimary\" }}\n            />\n          </ListItem>\n        ))}\n      </List>\n      <div className={classes.pagination}>\n        <Pagination\n          reduced\n          limit={numPerPage}\n          offset={offset}\n          total={60}\n          onClick={(e, newOffset): void => setOffset(newOffset)}\n        />\n      </div>\n    </Paper>\n  );\n}\n","import {\n  ExpansionPanel,\n  ExpansionPanelDetails,\n  ExpansionPanelSummary,\n  Container\n} from \"@material-ui/core\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport Typography from \"@material-ui/core/Typography\";\nimport ExpandMoreIcon from \"@material-ui/icons/ExpandMore\";\nimport Skeleton from \"@material-ui/lab/Skeleton\";\nimport React from \"react\";\n\nconst useStyles = makeStyles(() => ({\n  root: {\n    margin: 15\n  }\n}));\n\nexport default function PaperSheet() {\n  const classes = useStyles();\n\n  return (\n    <ExpansionPanel className={classes.root}>\n      <ExpansionPanelSummary expandIcon={<ExpandMoreIcon />}>\n        <Typography variant=\"subtitle1\">通知</Typography>\n      </ExpansionPanelSummary>\n      <ExpansionPanelDetails>\n        <Container>\n          <Skeleton />\n          <Skeleton width=\"60%\" />\n        </Container>\n      </ExpansionPanelDetails>\n    </ExpansionPanel>\n  );\n}\n","// 主页\nimport React from \"react\";\nimport { Grid, Hidden } from \"@material-ui/core\";\nimport Slides from \"./components/Slides\";\nimport Articles from \"./components/Articles\";\nimport Notifications from \"./components/Notifications\";\nimport NotificationsMobile from \"./components/NotificationsMobile\";\n\nexport default function Index(): JSX.Element {\n  return (\n    <>\n      <Grid container justify=\"center\">\n        <Hidden smUp>\n          <Grid item xs={12}>\n            <NotificationsMobile />\n          </Grid>\n        </Hidden>\n        <Grid item xs={12} md={8}>\n          <Slides />\n        </Grid>\n        <Grid item xs={12} sm={8}>\n          <Articles />\n        </Grid>\n        <Hidden xsDown>\n          <Grid item xs={12} sm={4}>\n            <Notifications />\n          </Grid>\n        </Hidden>\n      </Grid>\n    </>\n  );\n}\n","import { CircularProgress } from \"@material-ui/core\";\nimport CssBaseline from \"@material-ui/core/CssBaseline\";\nimport { createMuiTheme, MuiThemeProvider } from \"@material-ui/core/styles\";\nimport useMediaQuery from \"@material-ui/core/useMediaQuery\";\nimport React, { lazy, Suspense } from \"react\";\nimport { BrowserRouter, Route, Switch } from \"react-router-dom\";\nimport GlobalState from \"./context/GlobalState\";\nimport NavBar from \"./components/Navbar\";\nimport Footer from \"./components/Footer\";\nimport IndexPage from \"./pages/index/Index\";\nimport { PagePath, AdminAccess } from \"./types\";\nimport { AuthRoute } from \"./components/AuthRoute\";\n\nconst NotFoundPage = lazy(() => import(\"./pages/notFound/Index\"));\nconst AboutPage = lazy(() => import(\"./pages/about/Index\"));\nconst CheckPage = lazy(() => import(\"./pages/check/Index\"));\nconst ComplainPage = lazy(() => import(\"./pages/complain/Index\"));\nconst LankePage = lazy(() => import(\"./pages/lanke/Index\"));\nconst RepairPage = lazy(() => import(\"./pages/repair/Index\"));\nconst SuggestPage = lazy(() => import(\"./pages/suggest/Index\"));\nconst WechatPage = lazy(() => import(\"./pages/wechat/Index\"));\nconst AdminPage = lazy(() => import(\"./pages/admin/Index\"));\n\nfunction App(): JSX.Element {\n  const darkThemeSys = useMediaQuery(\"(prefers-color-scheme: dark)\", {\n    noSsr: true\n  });\n  const theme = createMuiTheme({\n    palette: {\n      primary: {\n        main: \"#0D56A6\"\n      },\n      secondary: {\n        main: \"#00acc1\"\n      },\n      type: darkThemeSys ? \"dark\" : \"light\"\n    }\n  });\n\n  return (\n    <MuiThemeProvider theme={theme}>\n      <GlobalState>\n        <BrowserRouter>\n          <CssBaseline />\n\n          {/* place holder for sticky footer */}\n          <div style={{ minHeight: \"calc(100vh - 176px)\" }}>\n            <NavBar />\n            <Suspense fallback={<CircularProgress />}>\n              <Switch>\n                <Route path={PagePath.Index} exact component={IndexPage} />\n                <Route path={PagePath.About} component={AboutPage} />\n                <Route path={PagePath.Check} component={CheckPage} />\n                <Route path={PagePath.Complain} component={ComplainPage} />\n                <Route path={PagePath.Lanke} component={LankePage} />\n                <Route path={PagePath.Suggest} component={SuggestPage} />\n                <Route path={PagePath.Wechat} component={WechatPage} />\n                <AuthRoute // [需认证]报修页面\n                  pageAccessCode={AdminAccess.Dashboard}\n                  path={PagePath.Repair}\n                >\n                  <RepairPage />\n                </AuthRoute>\n                <Route path={PagePath.Admin} component={AdminPage} />\n                {/* No Match */}\n                <Route component={NotFoundPage} />\n              </Switch>\n            </Suspense>\n          </div>\n\n          <Footer />\n        </BrowserRouter>\n      </GlobalState>\n    </MuiThemeProvider>\n  );\n}\n\nexport default App;\n","/* eslint-disable */\n// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\nimport * as serviceWorker from \"./serviceWorker\";\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n","import { Identity } from \"../types\";\n// import jwt_decode from \"jwt-decode\";\n\nexport const LOGIN = \"LOGIN\";\nexport const LOGOUT = \"LOGOUT\";\n\nexport const initialState = {\n  loggedIn: false,\n  userId: -1,\n  accessCode: 0,\n  identity: Identity.None,\n  expires: 0\n};\n\nexport const userReducer = (state, action) => {\n  switch (action.type) {\n    case LOGIN:\n      localStorage.setItem(\"authInfo\", action.token);\n      return {\n        ...state,\n        // eslint-disable-next-line no-undef\n        // ...jwt_decode(action.token),\n        loggedIn: true,\n        userId: 1,\n        identity: Identity.ROOT,\n        // accessCode: 0b01111111,\n        accessCode: 0b011111111,\n        expires: 99999999999\n      };\n    case LOGOUT:\n      localStorage.removeItem(\"authInfo\");\n      return initialState;\n    default:\n      return state;\n  }\n};\n","import React, { useReducer } from \"react\";\nimport { RestfulProvider } from \"restful-react\";\nimport { userReducer, LOGIN, LOGOUT, initialState } from \"./Reducer\";\nimport { AuthInfoProps, GlobalContextProps, Identity } from \"../types\";\n\nconst loginInit = (token: string): void => {\n  return;\n};\n\nconst logoutInit = (): void => {\n  return;\n};\n\nexport const authInfoContext = React.createContext<GlobalContextProps>({\n  authInfo: initialState,\n  login: loginInit,\n  logout: logoutInit\n});\n\nfunction getAuthInfo(): AuthInfoProps | null {\n  const token = localStorage.getItem(\"authInfo\");\n  if (token) {\n    // parse token\n    return {\n      loggedIn: true,\n      userId: 1,\n      identity: Identity.ROOT,\n      // accessCode: 0b01111111,\n      accessCode: 0b011111111,\n      expires: 99999999999\n    };\n  }\n  return null;\n}\n\nconst GlobalState = ({ children }: { children: JSX.Element }): JSX.Element => {\n  const [authInfo, dispatch] = useReducer(\n    userReducer,\n    getAuthInfo() || initialState\n  );\n\n  const login = (token: string): void => {\n    dispatch({ type: LOGIN, token });\n  };\n\n  const logout = (): void => {\n    dispatch({ type: LOGOUT });\n  };\n\n  return (\n    <authInfoContext.Provider\n      value={{\n        authInfo,\n        login,\n        logout\n      }}\n    >\n      <RestfulProvider base={process.env.REACT_APP_DOMAIN as string}>\n        {children}\n      </RestfulProvider>\n    </authInfoContext.Provider>\n  );\n};\n\nexport default GlobalState;\n","const axios = require('axios').default;\n\nconst instance = axios.create({\n    baseURL: \"http://lanunion.cqu.edu.cn/\",\n    timeout: 30000,\n    withCredentials: true\n})\n\n// don't know why this will work, but it works!\nconst readCookie = (name) => {\n    const nameEQ = name + \"=\";\n    const ca = document.cookie.split(';');\n    for(let i=0;i < ca.length;i++) {\n        let c = ca[i];\n        // eslint-disable-next-line\n        while (c.charAt(0)==' ') c = c.substring(1,c.length);\n        if (c.indexOf(nameEQ) === 0) return c.substring(nameEQ.length,c.length);\n    }\n    return null;\n}\n\ninstance.interceptors.request.use(\n    (config) => {\n        const csrfToken = readCookie('csrftoken');\n        if (csrfToken) {\n            config.headers['X-CSRFToken'] = csrfToken;\n        }\n        console.log(config)\n        return config\n    },\n    (error) => {\n        return Promise.reject(error)\n    }\n)\n\ninstance.interceptors.response.use(\n    (response) => {\n        return response.data\n    },\n    (error) => {\n        return Promise.reject(error)\n    }\n)\n\nexport default instance","import { ListItemIcon, MenuItem } from \"@material-ui/core\";\nimport Button from \"@material-ui/core/Button\";\nimport Dialog from \"@material-ui/core/Dialog\";\nimport DialogActions from \"@material-ui/core/DialogActions\";\nimport DialogContent from \"@material-ui/core/DialogContent\";\nimport DialogContentText from \"@material-ui/core/DialogContentText\";\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\n// import TextField from \"@material-ui/core/TextField\";\nimport FingerprintIcon from \"@material-ui/icons/Fingerprint\";\nimport PowerSettingsNewIcon from \"@material-ui/icons/PowerSettingsNew\";\nimport React, { useContext } from \"react\";\nimport { authInfoContext } from \"../context/GlobalState\";\nimport Api from \"../hooks/Api\";\n\nexport default function LoginDialog() {\n  const [open, setOpen] = React.useState(false);\n  const context = useContext(authInfoContext);\n  const { authInfo } = context;\n\n  const handleClickOpen = () => {\n    setOpen(true);\n  };\n\n  const handleClose = () => {\n    setOpen(false);\n  };\n\n  // const handleLogin = () => {\n  //   context.login(\"token\");\n  //   handleClose();\n  // };\n\n  const handleLogout = () => {\n    window.location.href = '/api/logout';\n    context.logout();\n  };\n\n  // TODO 登录信息存储\n  const handleCASLogin = () => {\n    window.location.href = '/repair/login.php';\n    context.login(\"token\");\n  };\n\n  const testPost = async () => {\n    const data = {\n      title: \"string\",\n      content: \"string\",\n      pinned: true,\n      public: true\n    }\n    await Api.post('/api/articles/', data).then(res => {\n      console.log(res)\n    })\n     \n\n  }\n\n  function LoginAndOut() {\n    if (authInfo.loggedIn) {\n      return (\n        <MenuItem\n          onClick={() => {\n            handleLogout();\n          }}\n        >\n          <ListItemIcon>\n            <PowerSettingsNewIcon />\n          </ListItemIcon>\n          登出\n        </MenuItem>\n      );\n    }\n    return (\n      <MenuItem\n        onClick={() => {\n          handleClickOpen();\n        }}\n      >\n        <ListItemIcon>\n          <FingerprintIcon />\n        </ListItemIcon>\n        登录\n      </MenuItem>\n    );\n  }\n\n  return (\n    <div>\n      <LoginAndOut />\n      <Dialog open={open} onClose={handleClose}>\n        <DialogTitle>登录</DialogTitle>\n        <DialogContent>\n          <DialogContentText>使用统一认证进行登陆</DialogContentText>\n          {/* <TextField\n            // autoFocus\n            margin=\"dense\"\n            id=\"account\"\n            label=\"账号\"\n            type=\"text\"\n            fullWidth\n          />\n          <TextField\n            margin=\"dense\"\n            id=\"pswd\"\n            label=\"密码\"\n            type=\"password\"\n            fullWidth\n          /> */}\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={handleClose} color=\"default\">\n            取消\n          </Button>\n          <Button onClick={testPost} color=\"primary\">\n            测试POST\n          </Button>\n          <Button onClick={handleCASLogin} color=\"primary\">\n            登录\n          </Button>\n        </DialogActions>\n      </Dialog>\n    </div>\n  );\n}\n","export interface AuthInfoProps {\n  loggedIn: boolean;\n  userId: number;\n  identity: Identity;\n  accessCode: number;\n  expires: number;\n}\n\nexport interface GlobalContextProps {\n  authInfo: AuthInfoProps;\n  login: (token: string) => void;\n  logout: () => void;\n}\n\nexport interface AuthRouteProps {\n  children: JSX.Element;\n  path: string;\n  pageAccessCode: AdminAccess;\n  exact?: boolean;\n}\n\nexport interface NavbarAdminItemProps {\n  label: string;\n  to: string;\n  icon: JSX.Element;\n  pageAccessCode: AdminAccess;\n  showDivider?: boolean;\n}\n\nexport enum PagePath {\n  Index = \"/\",\n  About = \"/about\",\n  Check = \"/check\",\n  Complain = \"/complain\",\n  Lanke = \"/lanke\",\n  Repair = \"/repair\",\n  Suggest = \"/suggest\",\n  Wechat = \"/wechat\",\n  Admin = \"/admin\"\n}\n\nexport enum PageLabel {\n  Index = \"首页\",\n  About = \"关于我们\",\n  Check = \"状态查询\",\n  Complain = \"投诉蓝客\",\n  Lanke = \"蓝客风采\",\n  Repair = \"故障报修\",\n  Suggest = \"意见建议\",\n  Wechat = \"公众号\",\n  Admin = \"后台\"\n}\n\nexport enum Identity {\n  None = \"none\",\n  USER = \"user\",\n  LANKE = \"lanke\",\n  LANKE_ADMIN = \"lankeAdmin\",\n  SUPER_ADMIN = \"superAdmin\",\n  ROOT = \"root\"\n}\n\nexport enum AdminAccess {\n  None = 0,\n  Dashboard = 1 << 0,\n  ModifyUserInfo = 1 << 1,\n  RepairUnreceived = 1 << 2,\n  RepairReceived = 1 << 2,\n  CommentManagement = 1 << 6,\n  Publish = 1 << 3,\n  UserManage = 1 << 4,\n  ApplyManage = 1 << 5,\n  CreditManage = 1 << 6,\n  Maintenance = 1 << 7\n}\n"],"sourceRoot":""}